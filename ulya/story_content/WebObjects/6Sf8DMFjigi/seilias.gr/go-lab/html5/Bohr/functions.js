/*!
* © by Sitsanlis Ilias
* This notice shall be included in all copies or substantial portions of the Software.
* Creative Commons 4.0/CC BY - NC - SA 4.0. 
*/

function toExp(e){for(var t=e.toExponential(2),r=t.indexOf("e"),a=t.substr(0,r),n=t.substr(r+2),o="",i=t.substr(r+1,1),s=0;s<=n.length-1;s++){var c=n.substr(s,1);o+="1"==c?"¹":"2"==c?"²":"3"==c?"³":String.fromCharCode("0x207"+c)}return"⁰"==o?a:a+"·10"+("-"==i?"⁻":"")+o}function round(e,t){return Number(e.toFixed(t))}function fixAngle(e){return e-360*Math.floor(e/360)}function rnd(e,t){return Math.floor(Math.random()*(t-e+1))+e}function getRandomColor(){return"#"+Math.random().toString(16).slice(2,8).toUpperCase()}function drawDotLine(e,t,r,a,n){var o=e.graphics;o.clear(),o.setStrokeStyle(.8),o.setStrokeDash([3,3],1),o.beginStroke("#666666"),o.moveTo(t,r),o.lineTo(a,n),o.endStroke()}function makeDragPoint(e,t){var r=new createjs.Container,a=new createjs.Shape,n=a.graphics;n.setStrokeStyle(1),n.beginStroke("#000000"),n.beginFill(t),n.dc(0,0,5),n.endStroke(),n.endFill(),a.hitArea=new createjs.Shape,a.hitArea.graphics.beginStroke("#FFFFFF"),a.hitArea.graphics.beginFill("#FFFFFF"),a.hitArea.graphics.dc(0,0,15),a.hitArea.graphics.endStroke(),a.hitArea.alpha=.01,r.name=e;var o=new createjs.Text("e","9px Trebuchet MS","#000000");return o.set({textAlign:"center"}),o.y=-5,o.x=0,r.addChild(a),r.addChild(o),r}function makeDragAndRotateLine(e){var t=new createjs.Container,r=makeDragPoint(),a=new createjs.Shape,n=a.graphics;return n.setStrokeStyle(1.5),n.setStrokeDash([5,5],1),n.beginStroke("#000000"),n.moveTo(0,0),n.lineTo(e,0),n.endStroke(),a.hitArea=new createjs.Shape,a.hitArea.graphics.setStrokeStyle(30),a.hitArea.graphics.beginStroke("#ffffff"),a.hitArea.graphics.mt(0,0),a.hitArea.graphics.lt(e,0),a.hitArea.graphics.endStroke(),a.hitArea.alpha=.01,a.name="line",r.x=0,r.y=0,a.regX=e/2,t.addChild(a),t.addChild(r),t.addEventListener("mousedown",mouseDownGen),t.addEventListener("pressup",pressUpGen),t}function drawArc(e,t,r,a,n,o,i){var s=e.graphics;s.clear(),s.beginStroke("#0099FF"),s.beginFill("#0099FF"),s.mt(t,r),s.arc(t,r,a,n,o,i),s.closePath(),s.endFill(),s.endStroke()}function drawAngle(e,t){var r=Math.min(e,t),a=Math.max(e,t);if(180<a-r){var n=a;a=r,r=n,a+=360}30<F1*FSCALE&&30<F*FSCALE?(drawArc(arc_mc,X0,Y0,25,-r*toRad,-a*toRad,1),self.θText_mc.visible=!0):(arc_mc.graphics.clear(),self.θText_mc.visible=!1),20<Math.abs(ω)?(self.θText_mc.x=X0+32*Math.cos((r+a)*toRad/2),self.θText_mc.y=Y0-32*Math.sin((r+a)*toRad/2)):self.θText_mc.visible=!1}function arangeVectorsInContainer(e){e.sortChildren(function(e,t){return Math.abs(e.F)>Math.abs(t.F)?-1:Math.abs(e.F)<Math.abs(t.F)?1:0})}function RGB2(e){var t,r,a,n;n=380<=e&&e<440?(r=-(e-440)/60,a=0,1):440<=e&&e<490?(r=0,a=(e-440)/50,1):490<=e&&e<510?(r=0,a=1,-(e-510)/20):510<=e&&e<580?(r=(e-510)/70,a=1,0):580<=e&&e<645?(r=1,a=-(e-645)/65,0):a=645<=e&&e<781?(r=1,0):r=0,t=380<=e&&e<420?.3+.7*(e-380)/40:420<=e&&e<701?1:701<=e&&e<781?.3+.7*(780-e)/80:0,R=0==r?0:Math.round(255*Math.pow(r*t,.8)),G=0==a?0:Math.round(255*Math.pow(a*t,.8)),B=0==n?0:Math.round(255*Math.pow(n*t,.8));var o=R.toString(16),i=G.toString(16),s=B.toString(16),c=(1==o.length?"0":"")+o+(1==i.length?"0":"")+i+(1==s.length?"0":"")+s;parseInt(c,16);return new Object({R:R,G:G,B:B,S:"#"+c.toUpperCase()})}function RGB3(e){var t;r=0,g=0,b=0,400<=e&&e<410?r=.33*(t=(e-400)/10)-.2*t*t:410<=e&&e<475?r=.14-.13*(t=(e-410)/65)*t:545<=e&&e<595?r=1.98*(t=(e-545)/50)-t*t:595<=e&&e<650?r=.98+.06*(t=(e-595)/55)-.4*t*t:650<=e&&e<700&&(r=.65-.84*(t=(e-650)/50)+.2*t*t),415<=e&&e<475?g=.8*(t=(e-415)/60)*t:475<=e&&e<590?g=.8+.76*(t=(e-475)/115)-.8*t*t:585<=e&&e<639&&(g=.84-.84*(t=(e-585)/54)),400<=e&&e<475?b=2.2*(t=(e-400)/75)-1.5*t*t:475<=e&&e<560&&(b=.7-(t=(e-475)/85)+.3*t*t);var a=Math.round(255*r),n=Math.round(255*g),o=Math.round(255*b),i=Math.round(255*r).toString(16),s=Math.round(255*g).toString(16),c=Math.round(255*b).toString(16),h=(1==i.length?"0":"")+i+(1==s.length?"0":"")+s+(1==c.length?"0":"")+c;parseInt(h,16);return new Object({R:a,G:n,B:o,S:"#"+h.toUpperCase()})}function RGB(e){var t=srgbXYZ2RGB(cie1931WavelengthToXYZFit(e)),r=Math.round(255*t[0]),a=Math.round(255*t[1]),n=Math.round(255*t[2]),o=Math.round(255*t[0]).toString(16),i=Math.round(255*t[1]).toString(16),s=Math.round(255*t[2]).toString(16),c=(1==o.length?"0":"")+o+(1==i.length?"0":"")+i+(1==s.length?"0":"")+s;return new Object({R:r,G:a,B:n,S:"#"+c.toUpperCase()})}function srgbXYZ2RGB(e){var t=e[0],r=e[1],a=e[2];rl=3.2406255*t+-1.537208*r+-.4986286*a,gl=-.9689307*t+1.8757561*r+.0415175*a,bl=.0557101*t+-.2040211*r+1.0569959*a;var n=[];return n[0]=srgbXYZ2RGBPostprocess(rl),n[1]=srgbXYZ2RGBPostprocess(gl),n[2]=srgbXYZ2RGBPostprocess(bl),n}function srgbXYZ2RGBPostprocess(e){return e=(e=1<e?1:e<0?0:e)<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}function cie1931WavelengthToXYZFit(e){var t,r,a,n=e,o=(n-442)*(n<442?.0624:.0374),i=(n-599.8)*(n<599.8?.0264:.0323),s=(n-501.1)*(n<501.1?.049:.0382);t=.362*Math.exp(-.5*o*o)+1.056*Math.exp(-.5*i*i)-.065*Math.exp(-.5*s*s),o=(n-568.8)*(n<568.8?.0213:.0247),i=(n-530.9)*(n<530.9?.0613:.0322),r=.821*Math.exp(-.5*o*o)+.286*Math.exp(-.5*i*i),o=(n-437)*(n<437?.0845:.0278),i=(n-459)*(n<459?.0385:.0725),a=1.217*Math.exp(-.5*o*o)+.681*Math.exp(-.5*i*i);var c=[];return c[0]=t,c[1]=r,c[2]=a,c}function drawPath(){for(var e=1;e<=6;e++){var t=new createjs.Shape,r=t.graphics,a=e*e*r1;r.setStrokeStyle(1.5),r.beginStroke("#999999"),r.dc(0,0,a*xScale),t.hitArea=new createjs.Shape,t.hitArea.graphics.setStrokeStyle(30),t.hitArea.graphics.beginStroke("#000000"),t.hitArea.graphics.dc(0,0,a*xScale),t.hitArea.graphics.endStroke(),t.addEventListener("mousedown",mouseDownGen),t.addEventListener("pressup",pressUpGen),t.name=e,path.addChild(t);var n=new createjs.Text("n="+e,"14px Cambria Math","#000000"),o=Math.asin((350-Y0)/yScale/(9*r1));if(e<=2)n.set({textAlign:"left"}),n.x=X0+a*xScale*Math.cos(o),n.y=Y0-a*xScale*Math.sin(o);else{n.set({textAlign:"center"});var i=Math.asin((320-Y0)/yScale/a);n.x=X0+a*xScale*Math.cos(i),n.y=320}numbers.addChild(n)}}function makePoint(){var e=new createjs.Shape,t=e.graphics;return t.setStrokeStyle(1),t.beginStroke("#FF0000"),t.beginFill("#FF0000"),t.dc(0,0,3),t.endStroke(),t.endFill(),e}function drawPhoton(e){var t=RGB(c/e*1e9),r=t.S,a=c/e*xScale/2e4;30<a&&(a=30),a<5&&(a=5);photon.graphics.clear().ss(1.5).s(r).mt(0,0);for(var n=Math.round(60/a),o=0,i=0;i<=n;i++){o+=.5/(n+1);var s="rgba("+t.R+","+t.G+","+t.B+","+o+")";photon.graphics.ss(1.5).s(s),photon.graphics.mt(i*a,0).qt(a/4+i*a,-6,a/2+i*a,0),o+=.5/(n+1);s="rgba("+t.R+","+t.G+","+t.B+","+o+")";photon.graphics.ss(1.5).s(s),photon.graphics.mt(a/2+i*a,0).qt(3*a/4+i*a,6,a+i*a,0)}photon.x=X0+RVector.x+drFinal/2-(n+1)*a*.707/2,photon.y=Y0+(n+1)*a*.707/2}function takeFrequency(e,t){return eV*Math.abs(E1/e/e-E1/t/t)/h}function myTween(){ε=drFinal<0?-1:1,dr<Math.abs(drFinal)-25?(dr+=Math.abs(drFinal)/30,dr>Math.abs(drFinal)&&(dr=Math.abs(drFinal)),RVector.setScaleX(ε*dr)):(RVector.removeEventListener("tick",myTween),playMovie?RVector.setScaleX(drFinal):RVector.setScaleX(drFinal-5*ε),dr=0,n=nf,ni=n)}function photonTween(){-40<photon.y?(photon.x+=6*dtSlow/dtInitial,photon.y-=6*dtSlow/dtInitial):(photon.removeEventListener("tick",photonTween),RVector.setScaleX(0),stageUpdateFlag=!1)}function drawColorBox(){var e=colorBox.graphics;e.clear();for(var t=700;400.5<=t;--t)e.beginStroke(RGB(t).S).setStrokeStyle(1).beginFill(color).dr(700-t,0,1,20)}function createLine(e){if(400<=e&&e<=700){var t=new createjs.Shape,r=t.graphics;r.beginStroke("#000000"),r.setStrokeStyle(3),r.beginStroke(RGB(e).S),r.moveTo(700-e,0).lt(700-e,20),colorBox.addChild(t)}}function drawScale(e,t){var r=new createjs.Shape,a=r.graphics;a.clear(),a.beginStroke(t).setStrokeStyle(1);for(var n=0;n<=300;n+=10)n%50!=0&&a.mt(n,0).lt(n,4);for(n=0;n<=300;n+=50){if(n%100!=0)a.mt(n,0).lt(n,6),(o=new createjs.Text((700-n).toFixed(0)+"","6px Trebuchet MS","#000000")).set({textAlign:"center"}),o.x=n,o.y=-8,e.addChild(o)}for(n=0;n<=300;n+=100){var o;0!=n&&300!=n&&a.mt(n,0).lt(n,9),(o=new createjs.Text((700-n).toFixed(0)+"","10px Trebuchet MS","#000000")).set({textAlign:"center"}),o.x=n,o.y=-10,e.addChild(o)}e.addChild(r)}function createVector(e,t,r,a){null==e&&(e="#000000"),null==t&&(t=!1),null==r&&(drawStart=!1);var n=new createjs.Container,o=new createjs.Shape;o=createLineVector(e,a),n.addChild(o);var i=new createjs.Shape;if(i=createArrowVector(e,a),n.addChild(i),t){var s=new createjs.Shape;s=createDragLineVector(),n.addChild(s)}if(r){var c=new createjs.Shape;c=createCircleVector(),n.addChild(c)}return n}function createLineVector(e,t){null==e&&(e="#000000");var r=new createjs.Shape,a=r.graphics;return t?a.setStrokeStyle(1.2):a.setStrokeStyle(1.6),a.beginStroke(e),a.moveTo(0,0),a.lineTo(100,0),a.endStroke(),r}function createDragLineVector(){var e=new createjs.Shape;return e.hitArea=new createjs.Shape,e.hitArea.graphics.f("CCC").dr(0,-12.5,100,25),e.alpha=.05,e.name="myDragLine",e}function createCircleVector(){var e=new createjs.Shape,t=e.graphics;return t.beginFill("#ffffff"),t.dc(0,0,15),e.alpha=.01,e.name="myDragCircle",e}function createArrowVector(e,t){null==e&&(e="#000000");var r=Math.PI/180,a=new createjs.Shape,n=a.graphics;if(n.setStrokeStyle(1.2,"round","round"),n.beginStroke(e),t){s=5,o=160,i=200;n.setStrokeStyle(1.2,"round","round"),n.beginStroke(e),n.moveTo(0,0),n.lineTo(s*Math.cos(o*r),-s*Math.sin(o*r)),n.moveTo(s*Math.cos(i*r),-s*Math.sin(i*r)),n.lineTo(0,0)}else{var o=155,i=205,s=8;n.setStrokeStyle(1.5,"round","round"),n.beginStroke(e),n.moveTo(0,0),n.lineTo(s*Math.cos(o*r),-s*Math.sin(o*r)),n.moveTo(s*Math.cos(i*r),-s*Math.sin(i*r)),n.lineTo(0,0)}return n.endStroke(),a.x=100,a}function updateTextVector(e,t,r,a){var n=t.rotation;arrowVec=t.getChildAt(1),(o=arrowVec.x)<0&&(o=Math.abs(o),n+=180);var o,i=(o=Math.abs(o))*Math.cos(n*toRad),s=o*Math.sin(n*toRad),c=t.x+i+r*Math.cos(n*toRad)+a*Math.cos((n+90)*toRad),h=t.y+s+r*Math.sin(n*toRad)+a*Math.sin((n+90)*toRad);e.x=c,e.y=h,e.textBaseline="alphabetic",e.textAlign="center",Math.abs(o)<5?e.alpha=0:e.alpha=1}function mouseDownVector(e){var t=canvas.width,r=canvas.height;e.target.offset={x:e.target.x-e.stageX*(720/t),y:e.target.y-e.stageY*(420/r)},e.target.addEventListener("pressmove",pressMoveVector)}function pressMoveVector(e){var t=canvas.width,r=canvas.height,a=e.stageX*(720/t)+e.target.offset.x,n=e.stageY*(420/r)+e.target.offset.y;e.target.x=a,e.target.y=n}function pressUpVector(e){e.target.parent.removeEventListener("pressmove",pressMoveVector)}function updateEnergyLevel(e){var t=-13.6/(e*e);currentLevel.y=-t*energySCALE,energyText.text=t.toFixed(2)+" eV",energyLevelText.text="n = "+e,energyLevelText.y=energyText.y=-t*energySCALE-5}createjs.Container.prototype.setScaleX=function(e){var t,r=this.getChildAt(0),a=this.getChildAt(1),n=this.getChildByName("myDragLine"),o=this.getChildByName("myDragCircle");null!=o&&(o.x=e),t=(a.x=e)<0?-1:1,25<=Math.abs(e)?(a.scaleX=t,r.scaleX=(e-t)/100,null!=n&&(n.scaleX=(e-t)/100)):(a.scaleX=4*e/100,r.scaleX=e/100-4*e/100/100,null!=n&&(n.scaleX=e/100-4*e/100/100))};